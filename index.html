<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Responsive Sidebar</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=PT+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <style>
        :root {
            --sidebar-width-collapsed: 60px;
            --secondary-menu-width-expanded: 200px;
            --primary-bg: #FFFFFF;
            --secondary-bg: #f5f6f8;
            --text-color: #3b4255;
            --icon-color: #6c7786;
            --hover-bg: #e4e7ed;
            --border-color: #e4e7ed;
            --shadow-color: rgba(0, 0, 0, 0.05);
        }

        [data-theme="dark"] {
            --primary-bg: #1A1A1A;
            --secondary-bg: #222222;
            --text-color: #EFEFEF;
            --icon-color: #9C9C9C;
            --hover-bg: #2C2C2C;
            --border-color: #3C3C3C;
            --shadow-color: rgba(0, 0, 0, 0.2);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'PT Sans', sans-serif;
            transition: color 0.3s ease, background-color 0.3s ease, transform 0.3s ease, left 0.3s cubic-bezier(0.2, 0, 0.2, 1), width 0.3s cubic-bezier(0.2, 0, 0.2, 1);
        }

        body {
            background-color: var(--secondary-bg);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        .sidebar {
            width: var(--sidebar-width-collapsed);
            background-color: var(--primary-bg);
            box-shadow: 2px 0 10px var(--shadow-color);
            position: relative;
            z-index: 100;
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-color);
        }

        .sidebar-header {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 60px;
        }

        .sidebar-main-menu {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            flex-grow: 1;
        }

        .sidebar-list {
            list-style: none;
            padding: 10px 0;
            display: flex;
            flex-direction: column;
        }

        .sidebar-list .sidebar-item {
            display: flex;
            align-items: center;
            height: 40px;
            padding: 0 10px;
            cursor: pointer;
            position: relative;
            color: var(--text-color);
            overflow: hidden;
            border-radius: 8px;
            margin: 0 10px 5px 10px;
            user-select: none;
        }

        .sidebar-list .sidebar-item.active {
            background-color: var(--hover-bg);
            color: var(--text-color);
        }

        .sidebar-item-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 100%;
            font-size: 20px;
            color: var(--icon-color);
        }

        .sidebar-item-label {
            display: none;
            opacity: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            padding-left: 10px;
            color: var(--text-color);
        }

        .sidebar.expanded .sidebar-item-label {
            display: flex;
            opacity: 1;
        }

        .sidebar-bottom {
            padding: 10px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: center;
        }

        .secondary-menu {
            position: absolute;
            top: 0;
            left: var(--sidebar-width-collapsed);
            height: 100%;
            width: 0;
            background-color: var(--primary-bg);
            box-shadow: 5px 0 10px var(--shadow-color);
            transition: width 0.3s cubic-bezier(0.2, 0, 0.2, 1), left 0.3s cubic-bezier(0.2, 0, 0.2, 1);
            overflow: hidden;
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            z-index: 99;
        }

        .secondary-menu.visible {
            width: var(--sidebar-width-collapsed);
            overflow-x: hidden;
        }

        .secondary-menu.expanded {
            width: var(--secondary-menu-width-expanded);
            overflow-y: auto;
        }

        .secondary-menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 60px;
            padding: 0 15px;
        }

        .secondary-menu-header .title {
            font-weight: bold;
            font-size: 1.1em;
            color: var(--text-color);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .secondary-menu.expanded .secondary-menu-header .title {
            opacity: 1;
        }

        .secondary-menu-header .btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.1em;
            color: var(--icon-color);
        }

        .secondary-menu-search {
            padding: 10px 10px;
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .secondary-menu.expanded .secondary-menu-search {
            display: flex;
            opacity: 1;
        }

        .secondary-menu-search .search-container {
            position: relative;
        }

        .secondary-menu-search .search-container .bx-search {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--icon-color);
        }

        .secondary-menu-search .search-input {
            width: 100%;
            padding: 8px 8px 8px 35px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: var(--secondary-bg);
            color: var(--text-color);
            outline: none;
        }

        .secondary-menu-list {
            list-style: none;
            padding: 10px 0;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .secondary-menu-heading {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .secondary-menu.expanded .secondary-menu-heading {
            display: block;
            opacity: 1;
            font-size: 1em;
            font-weight: bold;
            color: var(--icon-color);
            padding: 0px 15px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .secondary-menu-item {
            color: var(--text-color);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            white-space: nowrap;
        }

        .secondary-menu-item-main {
            display: flex;
            align-items: center;
            padding: 0px 15px;
            width: 100%;
            border-radius: 8px;
            justify-content: space-between;
        }

        .secondary-menu-item-icon {
            font-size: 20px;
            flex-shrink: 0;
            color: var(--icon-color);
            margin-right: 10px;
        }

        .secondary-menu.visible .secondary-menu-item-content {
            opacity: 0;
            display: none;
        }

        .toggle-caret {
            margin-left: auto;
            font-size: 20px;
            color: var(--icon-color);
            display: flex;
            align-items: center;        
            line-height: 1;
            transition: transform 0.3s ease;
        }
        .secondary-menu.visible .toggle-caret {
            opacity: 0;
            display: none;
        }

        .item-spacer {
            flex: 1;
        }
        .secondary-menu.visible .item-spacer {
            display: none;
        }

        .secondary-menu-item-label {
            flex-grow: 1;
            font-size: 0.8em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: var(--text-color);
        }

        .secondary-menu-item .toggle-caret {
            font-size: 16px;
            color: var(--icon-color);
            transition: transform 0.3s ease;
        }

        .secondary-menu-item.has-children.open .toggle-caret {
            transform: rotate(180deg);
        }

        .secondary-menu-item .dropdown-list {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            width: 100%;
        }

        .secondary-menu-item.open .dropdown-list {
            max-height: 200px;
            /* Adjust based on content */
        }

        .dropdown-item {
            padding: 8px 15px 8px 45px;
            font-size: 0.8em;
            white-space: normal;
            word-wrap: break-word;
        }


        .theme-switcher-container {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px 0;
            border-top: 1px solid var(--border-color);
        }

        .theme-switcher {
            width: 50px;
            height: 30px;
            border-radius: 15px;
            background-color: #d1d9e6;
            cursor: pointer;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .theme-switcher.dark {
            background-color: #3b3b3b;
        }

        .theme-switcher .bx {
            position: absolute;
            font-size: 18px;
            color: #fff;
            top: 50%;
            transform: translateY(-50%);
            transition: opacity 0.3s ease;
        }

        .theme-switcher .bx-sun {
            right: 5px;
            opacity: 1;
        }

        .theme-switcher.dark .bx-sun {
            opacity: 0;
        }

        .theme-switcher .bx-moon {
            left: 5px;
            opacity: 0;
        }

        .theme-switcher.dark .bx-moon {
            opacity: 1;
        }

        .theme-switcher-knob {
            width: 20px;
            height: 20px;
            background-color: var(--primary-bg);
            border-radius: 50%;
            position: absolute;
            left: 5px;
            top: 50%;
            transform: translateY(-50%);
            transition: left 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .theme-switcher.dark .theme-switcher-knob {
            left: 25px;
        }

        .secondary-menu.visible .secondary-menu-search {
            display: flex;
            align-items: center;
            opacity: 1;
        }

        .secondary-menu.visible .search-container {
            width: 30px;   
            height: 30px;
            background: var(--secondary-bg);
            border-radius: 8px;
            display: flex;
            align-items: center;
            padding: 5px;
            box-shadow: 0 1px 4px var(--shadow-color);
            margin: 0;     /* Remove extra margin */
            position: relative;
        }

        .secondary-menu.visible .search-input {
            display: none;
        }
        
        .secondary-menu.visible .bx-search {
            font-size: 20px;
            color: var(--icon-color);
            position: static;
            left: unset;
            top: unset;
            transform: none;
            margin: 0;
        }
    </style>
</head>

<body>

    <aside class="sidebar">
        <div class="sidebar-header">
            <span class="sidebar-item-icon"><i class='bx bx-menu'></i></span>
        </div>
        <div class="sidebar-main-menu">
            <ul class="sidebar-list">
                <li class="sidebar-item active" data-menu="dashboard">
                    <span class="sidebar-item-icon"><i class='bx bxs-dashboard'></i></span>
                    <span class="sidebar-item-label">Dashboard</span>
                </li>
                <li class="sidebar-item" data-menu="tasks">
                    <span class="sidebar-item-icon"><i class='bx bx-task'></i></span>
                    <span class="sidebar-item-label">Tasks</span>
                </li>
            </ul>
            <ul class="sidebar-list">
                <li class="sidebar-item" data-menu="settings">
                    <span class="sidebar-item-icon"><i class='bx bx-cog'></i></span>
                    <span class="sidebar-item-label">Settings</span>
                </li>
                <li class="sidebar-item" data-menu="profile">
                    <span class="sidebar-item-icon"><i class='bx bx-user'></i></span>
                    <span class="sidebar-item-label">Profile</span>
                </li>
            </ul>
        </div>
        <div class="sidebar-bottom">
            <div class="theme-switcher-container">
                <div class="theme-switcher">
                    <div class="theme-switcher-knob"></div>
                    <i class='bx bx-sun'></i>
                    <i class='bx bx-moon'></i>
                </div>
            </div>
        </div>
    </aside>

    <div class="secondary-menu" id="secondary-menu">
        <div class="secondary-menu-header">
            <span class="title" id="secondary-menu-title"></span>
            <span class="btn toggle-secondary-btn">
                <i class='bx bx-chevron-left' id="toggle-icon"></i>
            </span>
        </div>
        <div class="secondary-menu-search">
            <div class="search-container">
                <i class='bx bx-search'></i>
                <input type="text" class="search-input" placeholder="Search..." />
            </div>
        </div>
        <ul class="secondary-menu-list" id="secondary-menu-list"></ul>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const sidebar = document.querySelector('.sidebar');
            const secondaryMenu = document.getElementById('secondary-menu');
            const toggleSecondaryBtn = secondaryMenu.querySelector('.toggle-secondary-btn');
            const toggleIcon = document.getElementById('toggle-icon');
            const mainMenuItems = document.querySelectorAll('.sidebar-item');
            const secondaryMenuList = document.getElementById('secondary-menu-list');
            const secondaryMenuTitle = document.getElementById('secondary-menu-title');
            const themeSwitcher = document.querySelector('.theme-switcher');
            const html = document.documentElement;
            const searchIconBtn = secondaryMenuList.querySelector('.search-icon-btn');
            const secondaryMenuSearch = document.querySelector('.secondary-menu-search');

            let currentOpenMenu = null;
            let isSecondaryMenuExpanded = false;

            const menuData = {
                dashboard: {
                    title: "Dashboard",
                    items: [
                        { type: "heading", label: "Dashboard Types" },
                        { label: "Overview", icon: "bxs-dashboard" },
                        { label: "Executive Summary", icon: "bx-receipt", children: ["Project Timeline", "Resource Allocation", "Team Performance"] },
                        { label: "Operations Dashboard", icon: "bx-bar-chart-square", children: ["Project Timeline", "Resource Allocation", "Team Performance"] },
                        { label: "Financial Dashboard", icon: "bx-trending-up", children: ["Budget vs Actual", "Cash Flow Analysis", "Profit & Loss Summary"] },
                        { type: "heading", label: "Report Summaries" },
                        { label: "Weekly Reports", icon: "bx-list-ul", children: ["Team Productivity: 87%", "Project Completion: 12/15", "Budget Utilization: 75%"] },
                        { label: "Monthly Insights", icon: "bx-calendar", children: ["Revenue Growth: +15.3%", "New Clients: 24", "Team Expansion: 8 hires"] },
                        { label: "Quarterly Analysis", icon: "bx-stats", children: ["ROI: 23.4%", "Customer Retention: 92%", "Innovation Index: 8.7/10"] },
                        { type: "heading", label: "Business Intelligence" },
                        { label: "Performance Metrics", icon: "bx-rocket", children: ["Sales Conversion: 34.2%", "Lead Response Time: 2.3h", "Customer Lifetime Value..."] },
                        { label: "Predictive Analytics", icon: "bx-line-chart", children: ["Q4 Revenue Forecast: $2...", "Resource Demand: High", "Market Trends: Positive"] }
                    ]
                },
                tasks: {
                    title: "Tasks",
                    items: [
                        { type: "heading", label: "Quick Actions" },
                        { label: "New task", icon: "bx-plus" },
                        { label: "Filter tasks", icon: "bx-filter" },
                        { type: "heading", label: "My Tasks" },
                        { label: "Due today", icon: "bx-time-five", children: ["Review design mockups", "Update documentation"] },
                        { label: "In progress", icon: "bx-loader-circle", children: ["Implement user auth", "Database migration"] },
                        { label: "Completed", icon: "bx-check-circle", children: ["Fixed login bug", "Updated dependencies"] },
                        { type: "heading", label: "Other" },
                        { label: "Priority tasks", icon: "bxs-star", children: ["High Priority Task A", "High Priority Task B"] },
                        { label: "Archived", icon: "bx-archive", children: ["Archived Task 1", "Archived Task 2"] }
                    ]
                },
                settings: {
                    title: "Settings",
                    items: [
                        { type: "heading", label: "General" },
                        { label: "My Account", icon: "bx-user" },
                        { label: "Security", icon: "bx-lock" },
                        { type: "heading", label: "Preferences" },
                        { label: "Appearance", icon: "bx-palette" },
                        { label: "Notifications", icon: "bx-bell" },
                        { type: "heading", label: "Other" },
                        { label: "Integrations", icon: "bx-link" },
                        { label: "Help & Support", icon: "bx-help-circle" }
                    ]
                },
                profile: {
                    title: "Profile",
                    items: [
                        { type: "heading", label: "Profile" },
                        { label: "My Profile", icon: "bx-user-circle" },
                        { label: "Edit Profile", icon: "bx-cog" }
                    ]
                }
            };

            const expandSecondaryMenu = () => {
                secondaryMenu.classList.add('expanded');
                secondaryMenu.classList.remove('visible');
                toggleIcon.classList.remove('bx-chevron-right');
                toggleIcon.classList.add('bx-chevron-left');
                secondaryMenuTitle.style.display = 'block';
                secondaryMenuSearch.style.display = 'flex';
                secondaryMenuList.style.display = 'flex';
                isSecondaryMenuExpanded = true;
            };

            const collapseSecondaryMenu = () => {
                secondaryMenu.classList.remove('expanded');
                secondaryMenu.classList.add('visible');
                toggleIcon.classList.remove('bx-chevron-left');
                toggleIcon.classList.add('bx-chevron-right');
                secondaryMenuTitle.style.display = 'none';
                secondaryMenuSearch.style.display = 'flex';
                isSecondaryMenuExpanded = false;
                document.querySelectorAll('.secondary-menu-item.has-children').forEach(item => {
                    item.classList.remove('open');
                });
            };


            const showSecondaryMenu = (menuId) => {
                secondaryMenuList.innerHTML = '';
                const menu = menuData[menuId];
                secondaryMenuTitle.textContent = menu.title;

                secondaryMenuSearch.style.display = 'flex';
                secondaryMenuList.style.display = 'flex';
                secondaryMenuTitle.style.display = 'block';

                menu.items.forEach(item => {
                    const listItem = document.createElement('li');

                    if (item.type === 'heading') {
                        listItem.className = 'secondary-menu-heading';
                        listItem.textContent = item.label;
                    } else {
                        listItem.className = 'secondary-menu-item';
                        if (item.children) {
                            listItem.classList.add('has-children');
                        }
                        let itemContent = `<div class="secondary-menu-item-main">
                                                <span class="secondary-menu-item-icon"><i class='bx ${item.icon}'></i></span>
                                                <div class="secondary-menu-item-content">
                                                    <span class="secondary-menu-item-label">${item.label}</span>
                                                </div>`;
                        if (item.children) {
                            itemContent += `<span class="toggle-caret"><i class='bx bx-chevron-down'></i></span>`;
                        } else {
                            itemContent += `<span class="item-spacer"></span>`;
                        }
                        itemContent += `</div>`;
                        listItem.innerHTML = itemContent;

                        if (item.children) {
                            const dropdownList = document.createElement('ul');
                            dropdownList.className = 'dropdown-list';
                            item.children.forEach(child => {
                                const dropdownItem = document.createElement('li');
                                dropdownItem.className = 'dropdown-item';
                                dropdownItem.textContent = child;
                                dropdownList.appendChild(dropdownItem);
                            });
                            listItem.appendChild(dropdownList);

                            listItem.querySelector('.toggle-caret').addEventListener('click', (event) => {
                                event.stopPropagation();
                                listItem.classList.toggle('open');
                            });
                        }
                    }
                    secondaryMenuList.appendChild(listItem);
                });

                if (!secondaryMenu.classList.contains('visible') && !secondaryMenu.classList.contains('expanded')) {
                    secondaryMenu.classList.add('visible');
                    toggleIcon.classList.remove('bx-chevron-left');
                    toggleIcon.classList.add('bx-chevron-right');
                    isSecondaryMenuExpanded = false;
                }
            };

            toggleSecondaryBtn.addEventListener('click', () => {
                if (isSecondaryMenuExpanded) {
                    collapseSecondaryMenu();
                } else {
                    expandSecondaryMenu();
                }
            });

            mainMenuItems.forEach(item => {
                item.addEventListener('click', () => {
                    mainMenuItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    showSecondaryMenu(item.dataset.menu);
                });
            });
            themeSwitcher.addEventListener('click', () => {
                const currentTheme = html.getAttribute('data-theme');
                if (currentTheme === "dark") {
                    html.removeAttribute('data-theme');
                    themeSwitcher.classList.remove('dark');
                } else {
                    html.setAttribute('data-theme', 'dark');
                    themeSwitcher.classList.add('dark');
                }
            });

            secondaryMenuSearch.style.display = 'none';
        });
    </script>
</body>

</html>
